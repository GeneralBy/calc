При решении задачи не использовал готовые варианты из сети. Придумал свое, неповторимое, рабочее решение, хотя на реализацию ушло больше времени, чем ожидал. 
Заранее благодарен человеку, который будет анализировать код.
